{% extends 'base.html' %}

{% load bootstrap i18n static laboratory %}

{% block title %}{% if form.type.value == "0" %} {% trans 'Reactive management' %}{% elif form.type.value == "1" %}{% trans 'Material management' %}{% elif form.type.value == "2" %}{% trans 'Equipment management' %}{% else %} {% trans 'Object management' %} {% endif %} {% endblock %}

{% block content %}
{%  has_perms "laboratory.add_object" as perm_add_object %}
{%  has_perms "laboratory.chage_object" as perm_chage_object %}

  <div class="row">
    <div class="col-md-6 col-md-offset-4">
      <h1 align="center">{% if form.type.value == "0" %} {% trans 'Reactive management' %}{% elif form.type.value == "1" %}{% trans 'Material management' %}{% elif form.type.value == "2" %}{% trans 'Equipment management' %}{% else %} {% trans 'Object management' %} {% endif %}</h1>
      {% if perm_add_object or perm_chage_object  %}
	      <form enctype="multipart/form-data" action="
	        {% if form.instance.pk %}{% url 'laboratory:objectview_update' laboratory form.instance.pk %}{% else %}{% url 'laboratory:objectview_create' laboratory %} {% endif %}"
	            method="post">{% csrf_token %}
	                  
	        {{ form|bootstrap }}
	        <input class="btn btn-info" type="submit" value="{% trans 'Save' %}"/>
	      </form>

	         <div>    
    <br>
    <br>
       {% if form.type.value == "0" %} 
             <button id='button-edit-kekule' type="button"   data-widget="Kekule.Widget.Button" class="K-Chem-Viewer-Edit K-Normal-Background K-Container K-Toolbar K-Button-Group K-NonSelectable K-Corner-All K-No-Wrap K-Layout-H K-Dynamic-Created K-Text-Hide K-Glyph-Show K-Chem-InnerToolbar K-Chem-Viewer-Embedded-Toolbar K-State-Normal" draggable="false" title="Open an editor to modify displayed object"><span class=" K-Content K-Glyph-Content K-Dynamic-Created K-Pri-Glyph-Content"></span><span class=" K-Content K-Text-Content K-Dynamic-Created">{% trans 'Edit...' %}</span><span class=" K-Content K-Glyph-Content K-Dynamic-Created K-Assoc-Glyph-Content"></span></button>
             
             <div id="object-formule" class="object_formule_draw ">
		              <div class="object" id="viewerobject1" data-widget="Kekule.ChemWidget.Viewer2D" data-predefined-setting="editOnly" data-auto-size="true"  >
		     </div>

			<script>
			   var viewer;
			   var mol;
			   var container = "object-formule";
			   var field =  "id_molecular_formula";
			   var fieldViewer = 'viewerobject1';
				Kekule.Indigo.enable();	
				$(document).ready(function() {
					kekule_prepareViewers();
					kekule_add_events();
					button1 = Kekule.Widget.getWidgetById('button-edit-kekule');
					button1.addEventListener('execute', function(){ alert('button1 executed'); });
					
				});
				$( "#"+container ).insertAfter( $("#"+field).parent() );
				$('#button-edit-kekule').insertAfter( $("#"+field).parent() );
			
		    </script>
	     {% endif %}
      {% else %} 
          {% include 'laboratory/action_denied.html' %} 
      {% endif %}
    </div>
  </div>
  <br> <br>
{% endblock %}

{% block js %}
  <script type="text/javascript" src="{% static 'laboratory/js/objectview.js' %}"></script>
{% endblock %}
